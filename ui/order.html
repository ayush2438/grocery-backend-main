<!DOCTYPE html>
<html>
<head>
    <title>GSMS - New Order</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- ✅ Login protection script -->
    <script>
      if (localStorage.getItem("loggedIn") !== "true") {
        window.location.href = "login.html";
      }
    </script>

    <!-- Stylesheets -->
    <link media="all" type="text/css" rel="stylesheet" href="css/bootstrap.min.css">
    <link media="all" type="text/css" rel="stylesheet" href="css/style.css?v=1.0">
    <link media="all" type="text/css" rel="stylesheet" href="css/custom.css?v=1.3.3">
</head>
<body class="tooltips">

<div class="container">

    <!-- ✅ Logout button -->
    <div class="text-end mt-3 mb-3">
        <button onclick="logout()" class="btn btn-danger btn-sm">Logout</button>
    </div>

    <div class="right content-page">
        <div class="body content rows scroll-y">
            <form id="orderForm">
                <!-- Customer Name -->
                <div class="box-info full" id="taskFormContainer">
                    <h2>New Order
                        <input name="customerName" id="customerName" type="text" class="form-control"
                               placeholder="Customer Name"
                               style="max-width:230px; float: right;margin-top: -11px" required>
                    </h2>

                    <!-- Column Headings -->
                    <div class="row" style="margin-bottom: 5px;margin-top: -10px;">
                        <div class="col-sm-12">
                            <div class="col-sm-4"><label>Product</label></div>
                            <div class="col-sm-3"><label>Price</label></div>
                            <div class="col-sm-2"><label>Quantity</label></div>
                            <div class="col-sm-3">
                                <label>Total</label>
                                <button class="btn btn-sm btn-primary pull-right" style="margin-top: -5px"
                                        type="button" id="addMoreButton">Add More
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Product Rows Will Be Appended Here -->
                <div class="product-box-extra" id="itemsInOrder"></div>

                <!-- Grand Total and Save Button -->
                <div class="row">
                    <div class="col-sm-12">
                        <div class="box-info full p-3 mb-3 mt-0">
                            <div class="col-sm-9 text-right"><span><b>Total</b></span></div>
                            <div class="col-sm-3">
                                <b>
                                    <input id="product_grand_total" name="product_grand_total"
                                           class="product-grand-total form-control"
                                           value="0.0" readonly> Rs
                                </b>
                                <button class="btn btn-sm btn-primary pull-right" type="button" id="saveOrder">Save
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>

            <!-- Hidden Template for Cloning -->
            <div class="product-box hidden">
                <div class="row product-item">
                    <div class="col-sm-12">
                        <div class="box-info full p-3 mb-3 mt-0">
                            <!-- Product Select -->
                            <div class="col-sm-4">
                                <select name="product" class="form-control cart-product" style="max-width: 250px"
                                        required></select>
                            </div>

                            <!-- Price -->
                            <div class="col-sm-3">
                                <input id="product_price" name="product_price" class="form-control product-price"
                                       value="0.0" readonly>
                            </div>

                            <!-- Quantity -->
                            <div class="col-sm-2">
                                <input name="qty" type="number" min="1"
                                       class="form-control product-qty" value="1" style="max-width: 100px">
                            </div>

                            <!-- Total + Remove -->
                            <div class="col-sm-3">
                                <input id="item_total" name="item_total" class="form-control item-total"
                                       value="0.0" readonly>
                                <span> Rs</span>
                                <button class="btn btn-sm btn-danger pull-right remove-row"
                                        type="button">Remove</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div> <!-- End Hidden Template -->
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="js/packages/jquery.min.js"></script>
<script src="js/custom/common.js"></script>
<script src="js/custom/order.js"></script>

<!-- ✅ Logout script -->
<script>
  function logout() {
    localStorage.clear();
    window.location.href = "login.html";
  }
</script>
</body>
</html>
